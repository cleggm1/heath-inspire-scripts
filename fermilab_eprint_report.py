import re
from invenio.search_engine import perform_request_search
from invenio.search_engine import get_fieldvalues
from invenio.bibformat_engine import BibFormatObject
import invenio.bibformat_elements.bfe_INSPIRE_arxiv as bfe_arxiv

search = '035:/astro-ph/'
search = 'find primarch astro-ph not tc p not tc c and date < 2009'
search = 'find r fermilab and date 2014-05'
search = """find r FERMILAB-CONF-09-830-AD
or FERMILAB-CONF-09-832-PPD
or FERMILAB-CONF-09-833-E
or FERMILAB-CONF-09-834-E
or FERMILAB-CONF-09-835-E
or FERMILAB-CONF-09-836-E
or FERMILAB-CONF-09-837-E
or FERMILAB-CONF-10-693-E
or FERMILAB-CONF-10-694-E
or FERMILAB-CONF-10-695-E
or FERMILAB-CONF-10-696-E
or FERMILAB-CONF-10-697-E
or FERMILAB-CONF-10-698-E
or FERMILAB-CONF-10-699-E
or FERMILAB-CONF-08-704-E
or FERMILAB-CONF-08-705-E
or FERMILAB-CONF-08-706-E
or FERMILAB-CONF-08-707-E
or FERMILAB-CONF-00-399-CD
or FERMILAB-CONF-99-411-CD
or FERMILAB-CONF-99-412-CD
or FERMILAB-PUB-99-413-CD
or FERMILAB-CONF-11-426-AD
or FERMILAB-CONF-11-455-AD
or FERMILAB-FN-0931-AE
or FERMILAB-PUB-11-485-PPD
or FERMILAB-CONF-11-495-PPD
or FERMILAB-CONF-10-701-APC
or FERMILAB-FN-0935-APC
or FERMILAB-CONF-11-519-CD
or FERMILAB-PUB-11-531-CD-E
or FERMILAB-PUB-11-554-PPD
or FERMILAB-FN-0936-PPD
or FERMILAB-PUB-11-600-T
or FERMILAB-PUB-11-604-T
or FERMILAB-PUB-11-672-E-PPD
or FERMILAB-PUB-11-673-PPD
or FERMILAB-PUB-12-006-A
or FERMILAB-TM-2525
or FERMILAB-PUB-12-042-PPD
or FERMILAB-TM-2528-APC-CD
or FERMILAB-CONF-12-063-E
or FERMILAB-FN-0944
or FERMILAB-TM-2531
or FERMILAB-CONF-12-089-AD
or FERMILAB-PUB-12-090-AE
or FERMILAB-TM-2535-E
or FERMILAB-CONF-12-220-AD
or FERMILAB-CONF-12-277-E
or FERMILAB-CONF-12-300-CD-CMS
or FERMILAB-CONF-12-303-CD
or FERMILAB-PUB-11-780-PPD
or FERMILAB-PUB-12-329-E
or FERMILAB-PUB-12-334-PPD
or FERMILAB-PUB-12-351-A
or FERMILAB-PUB-12-374-PPD
or FERMILAB-CONF-12-379-APC
or FERMILAB-CONF-12-386-PPD
or FERMILAB-PUB-12-402-PPD
or FERMILAB-PUB-12-407-E
or FERMILAB-CONF-12-414-APC
or FERMILAB-FN-0949-AD
or FERMILAB-CONF-12-524-CD
or FERMILAB-PUB-12-536-A
or FERMILAB-PUB-12-540-PPD
or FERMILAB-TEST-12-003-BSS
or FERMILAB-CONF-12-545-AD-TD
or FERMILAB-PUB-09-845-CMS
or FERMILAB-PUB-09-846-CMS
or FERMILAB-PUB-10-727-CMS
or FERMILAB-PUB-12-562-AD-APC
or FERMILAB-PUB-11-816-CMS
or FERMILAB-PUB-12-651-PPD
or FERMILAB-CONF-04-559-APC
or FERMILAB-CONF-03-528-AD
or FERMILAB-FN-0953-APC
or FERMILAB-CONF-03-529-AD
or FERMILAB-TEST-13-001-A
or FERMILAB-CONF-01-533-APC
or FERMILAB-CONF-99-000-AD
or FERMILAB-TM-2552-TD
or FERMILAB-PUB-13-043-T
or FERMILAB-CONF-13-056-AD
or FERMILAB-CONF-13-058-AD
or FERMILAB-CONF-13-060-AD-APC
or FERMILAB-PUB-13-070-E-PPD
or FERMILAB-CONF-13-074-CD
or FERMILAB-PUB-13-075-T
or FERMILAB-CONF-13-078-PPD
or FERMILAB-PUB-06-591-PPD
or FERMILAB-PUB-12-668-PPD
or FERMILAB-CONF-13-110-AD
or FERMILAB-CONF-13-112-AD
or FERMILAB-CONF-12-723-E
or FERMILAB-FN-0959-APC
or FERMILAB-CONF-13-211-PPD
or FERMILAB-TM-2559-APC-PPD
or FERMILAB-CONF-13-245-AD-APC-PPD-T-TD
or FERMILAB-PUB-13-283-T
or FERMILAB-TM-2562-APC
or FERMILAB-CONF-13-292-AD
or FERMILAB-CONF-13-293-AD
or FERMILAB-CONF-13-294-AD
or FERMILAB-CONF-13-312-AD
or FERMILAB-PUB-13-316-PPD
or FERMILAB-CONF-10-731-PPD
or FERMILAB-CONF-11-882-CD
or FERMILAB-CONF-13-359-TD
or FERMILAB-CONF-13-369-TD
or FERMILAB-CONF-13-378-AD
or FERMILAB-PUB-13-384-CMS
or FERMILAB-PUB-13-385-E
or FERMILAB-CONF-13-000-DI
or FERMILAB-TM-2568
or FERMILAB-CONF-13-482-CD
or FERMILAB-PUB-13-491-CD
or FERMILAB-CONF-13-496-CD
or FERMILAB-PUB-13-503-T
or FERMILAB-PUB-13-530-T
or FERMILAB-PUB-13-532-T
or FERMILAB-CONF-13-558-T
or FERMILAB-TEST-13-003-BSS
or FERMILAB-PUB-13-576-E-PPD
or FERMILAB-CONF-13-578-T
or FERMILAB-PUB-14-013-A
or FERMILAB-TM-2578-CD
or FERMILAB-CONF-14-019
or FERMILAB-PUB-14-026-PPD
or FERMILAB-CONF-12-911-E
or FERMILAB-PUB-14-049-AD-TD
or FERMILAB-TM-2583-PPD
or FERMILAB-PUB-14-085-CMS
or FERMILAB-PUB-12-913-CMS
or FERMILAB-PUB-12-918-CMS
or FERMILAB-PUB-08-716-CMS
or FERMILAB-PUB-07-807-CMS
or FERMILAB-PUB-07-808-CMS
or FERMILAB-PUB-07-809-CMS
or FERMILAB-PUB-06-592-CMS
or FERMILAB-CONF-14-097-E
or FERMILAB-PUB-14-112-PPD
or FERMILAB-CONF-13-648
or FERMILAB-TEST-14-001-AE-DI
or FERMILAB-TEST-14-002-BSS
or FERMILAB-CONF-14-149-AD
or FERMILAB-PUB-14-153-CMS
or FERMILAB-PUB-14-156-TD
or FERMILAB-PUB-14-158-TD
or FERMILAB-PUB-14-159-TD
or FERMILAB-TM-2585
or FERMILAB-CONF-14-221-APC
or FERMILAB-CONF-14-223-PPD
or FERMILAB-PUB-14-238-PPD
or FERMILAB-PUB-14-245-TD
or FERMILAB-TEST-14-003-ESH
or FERMILAB-PUB-14-272-T
or FERMILAB-CONF-14-275-T
or FERMILAB-PUB-14-284-T
or FERMILAB-CONF-13-665-T
or FERMILAB-PUB-14-289-A
or FERMILAB-PUB-08-717-E
or FERMILAB-PUB-14-300-T
or FERMILAB-PUB-14-303-A
or FERMILAB-PUB-14-308-CD
or FERMILAB-PUB-14-310-T
or FERMILAB-CONF-03-538-TD
or FERMILAB-PUB-14-312-A
or FERMILAB-PUB-14-313-T
or FERMILAB-PUB-14-316-CD
or FERMILAB-PUB-13-669
or FERMILAB-PUB-13-670
or FERMILAB-PUB-14-327-A
or FERMILAB-PUB-13-672-TD
or FERMILAB-PUB-14-350
or FERMILAB-CONF-14-355-E
or FERMILAB-FN-0988-APC
or FERMILAB-PUB-14-357-APC
or FERMILAB-PUB-07-811-T
or FERMILAB-PUB-14-359-T
or FERMILAB-PUB-00-408-T
or FERMILAB-PUB-14-366-CMS
or FERMILAB-PUB-14-367-CMS
or FERMILAB-PUB-14-368-CMS
or FERMILAB-PUB-13-681-A
or FERMILAB-PUB-14-379-PPD
or FERMILAB-CONF-14-380-TD
or FERMILAB-PUB-14-386-T
or FERMILAB-PUB-14-387-A
or FERMILAB-PUB-14-392-T
or FERMILAB-PUB-07-819-A
or FERMILAB-CONF-14-394-T
or FERMILAB-PUB-06-607-A
or FERMILAB-PUB-14-396-T
or FERMILAB-PUB-14-402-E
or FERMILAB-PUB-14-408-A
or FERMILAB-FN-0991-APC
or FERMILAB-PUB-14-411-T
or FERMILAB-PUB-06-613-T
or FERMILAB-TEST-14-006-ND
or FERMILAB-CONF-14-423-PPD
or FERMILAB-FN-0992-E
or FERMILAB-CONF-14-449-T
or FERMILAB-CONF-14-453-PPD
or FERMILAB-PUB-14-456-AE-E
or FERMILAB-PUB-14-461-T
or FERMILAB-PUB-14-468-A
or FERMILAB-PUB-14-471-T
or FERMILAB-PUB-14-473-A
or FERMILAB-PUB-14-477-A
or FERMILAB-PUB-14-485-T
or FERMILAB-PUB-14-504-T
or FERMILAB-TM-2592-AD-APC
or FERMILAB-PUB-14-507-T
or FERMILAB-PUB-14-517-T
or FERMILAB-CONF-14-520-T
or FERMILAB-CONF-14-521-T
or FERMILAB-PUB-14-522-PPD
or FERMILAB-PUB-14-527-APC
or FERMILAB-FN-0994-PPD
or FERMILAB-TM-2594
or FERMILAB-PUB-15-001-T
or FERMILAB-TEST-15-595-AD
or FERMILAB-TEST-15-006-FESS
or FERMILAB-PUB-15-004-PPD
or FERMILAB-PUB-14-538-A
or FERMILAB-PUB-15-009-A
or FERMILAB-PUB-15-010-T
or FERMILAB-CONF-15-011-E
or FERMILAB-PUB-15-015-A
or FERMILAB-CONF-15-017-CD-ND
or FERMILAB-PUB-15-018-ND
or FERMILAB-PUB-15-022-AE
or FERMILAB-PUB-15-030-T
or FERMILAB-PUB-15-032-A
or FERMILAB-PUB-15-033-PPD
or FERMILAB-PUB-15-035-A
or FERMILAB-PUB-15-036-ND
or FERMILAB-CONF-15-037-A
or FERMILAB-FN-0997-ND-T
"""

x = perform_request_search(p=search,cc='HEP')
for r in x:
    report_fermilab = ''
    eprint = ''
    reports = get_fieldvalues(r,'037__a')
    for report in reports:
        if re.search("FERMILAB", report):
            report_fermilab = report
    bfo = BibFormatObject(r)
    eprint = bfe_arxiv.get_arxiv(bfo, category = "no")
    if eprint: 
        eprint = eprint[0]
        if report_fermilab:
            print report_fermilab, eprint
#        out += format_bibtex_field("eprint",
#                                   eprints[0],
#                                   name_width,
#                                   value_width)
#        out += format_bibtex_field("archivePrefix",
#                                   "arXiv",
#                                   name_width,
#                                   value_width)
