import re
from invenio.search_engine import perform_request_search
from invenio.search_engine import get_fieldvalues
from invenio.bibformat_engine import BibFormatObject
import invenio.bibformat_elements.bfe_INSPIRE_arxiv as bfe_arxiv

search = '035:/astro-ph/'
search = 'find primarch astro-ph not tc p not tc c and date < 2009'
search = 'find r fermilab and date 2014-05'
search = """find r FERMILAB-PUB-11-687-T
or FERMILAB-CONF-09-776-E
or FERMILAB-CONF-09-777-E
or FERMILAB-CONF-10-628-E
or FERMILAB-PUB-10-629-E
or FERMILAB-PUB-10-630-E
or FERMILAB-CONF-10-631-E
or FERMILAB-PUB-10-632-E
or FERMILAB-PUB-10-633-E
or FERMILAB-PUB-10-634-E
or FERMILAB-CONF-10-635-E
or FERMILAB-PUB-10-636-E
or FERMILAB-CONF-10-638-E
or FERMILAB-PUB-10-639-E
or FERMILAB-PUB-10-641-E
or FERMILAB-PUB-10-645-E
or FERMILAB-PUB-09-778-AD
or FERMILAB-PUB-09-779-AD
or FERMILAB-PUB-08-697-AD
or FERMILAB-PUB-08-698-AD
or FERMILAB-PUB-10-649-AD
or FERMILAB-TM-2499-AD
or FERMILAB-TM-2500-AD
or FERMILAB-PUB-10-651-E
or FERMILAB-CONF-10-653-E
or FERMILAB-CONF-09-780-CD
or FERMILAB-CONF-09-781-E
or FERMILAB-CONF-09-782-E
or FERMILAB-CONF-09-783-E
or FERMILAB-CONF-10-654-CMS-E
or FERMILAB-CONF-09-784-AD-CD-E
or FERMILAB-CONF-09-785-E
or FERMILAB-CONF-10-656-AD-E
or FERMILAB-CONF-09-786-APC
or FERMILAB-CONF-09-787-APC
or FERMILAB-CONF-10-657-CD
or FERMILAB-CONF-09-788-A-E
or FERMILAB-CONF-09-789-E
or FERMILAB-CONF-10-658-CD
or FERMILAB-CONF-10-659-CD
or FERMILAB-CONF-10-660-T
or FERMILAB-PUB-08-699-E
or FERMILAB-PUB-99-410-T
or FERMILAB-CONF-11-346-PPD
or FERMILAB-CONF-11-353-AD
or FERMILAB-TM-2514-AD
or FERMILAB-PUB-10-662-TD
or FERMILAB-CONF-09-791-AD
or FERMILAB-CONF-09-792-E
or FERMILAB-PUB-10-665-PPD
or FERMILAB-CONF-09-793-APC
or FERMILAB-CONF-10-671-APC
or FERMILAB-CONF-08-702-E
or FERMILAB-CONF-10-672-E
or FERMILAB-CONF-08-703-T
or FERMILAB-CONF-09-798-E
or FERMILAB-CONF-09-799-E
or FERMILAB-CONF-09-800-E
or FERMILAB-CONF-09-801-E
or FERMILAB-CONF-09-802-E
or FERMILAB-CONF-09-803-E
or FERMILAB-CONF-09-813-AD
or FERMILAB-CONF-09-814-AD
or FERMILAB-CONF-09-815-AD
or FERMILAB-CONF-09-816-AD
or FERMILAB-CONF-09-827-AD
or FERMILAB-CONF-09-828-AD
or FERMILAB-CONF-09-829-AD
or FERMILAB-CONF-09-830-AD
or FERMILAB-CONF-09-832-PPD
or FERMILAB-CONF-09-833-E
or FERMILAB-CONF-09-834-E
or FERMILAB-CONF-09-835-E
or FERMILAB-CONF-09-836-E
or FERMILAB-CONF-09-837-E
or FERMILAB-CONF-10-693-E
or FERMILAB-CONF-10-694-E
or FERMILAB-CONF-10-695-E
or FERMILAB-CONF-10-696-E
or FERMILAB-CONF-10-697-E
or FERMILAB-CONF-10-698-E
or FERMILAB-CONF-10-699-E
or FERMILAB-CONF-08-704-E
or FERMILAB-CONF-08-705-E
or FERMILAB-CONF-08-706-E
or FERMILAB-CONF-08-707-E
or FERMILAB-CONF-00-399-CD
or FERMILAB-CONF-99-411-CD
or FERMILAB-CONF-99-412-CD
or FERMILAB-PUB-99-413-CD
or FERMILAB-CONF-11-426-AD
or FERMILAB-CONF-11-455-AD
or FERMILAB-FN-0931-AE
or FERMILAB-PUB-11-485-PPD
or FERMILAB-CONF-11-495-PPD
or FERMILAB-CONF-10-701-APC
or FERMILAB-FN-0935-APC
or FERMILAB-CONF-11-519-CD
or FERMILAB-PUB-11-531-CD-E
or FERMILAB-PUB-11-554-PPD
or FERMILAB-FN-0936-PPD
or FERMILAB-PUB-11-600-T
or FERMILAB-PUB-11-604-T
or FERMILAB-PUB-11-672-E-PPD
or FERMILAB-PUB-11-673-PPD
or FERMILAB-PUB-12-006-A
or FERMILAB-PUB-11-687-T
or FERMILAB-TM-2525
or FERMILAB-PUB-12-042-PPD
or FERMILAB-TM-2528-APC-CD
or FERMILAB-CONF-12-063-E
or FERMILAB-FN-0944
or FERMILAB-TM-2531
or FERMILAB-CONF-12-089-AD
or FERMILAB-PUB-12-090-AE
or FERMILAB-TM-2535-E
or FERMILAB-CONF-12-220-AD
or FERMILAB-CONF-12-277-E
or FERMILAB-CONF-12-300-CD-CMS
or FERMILAB-CONF-12-303-CD
or FERMILAB-PUB-11-780-PPD
or FERMILAB-PUB-12-329-E
or FERMILAB-PUB-12-334-PPD
or FERMILAB-PUB-12-351-A
or FERMILAB-PUB-12-374-PPD
or FERMILAB-CONF-12-379-APC
or FERMILAB-CONF-12-386-PPD
or FERMILAB-PUB-12-402-PPD
or FERMILAB-PUB-12-407-E
or FERMILAB-CONF-12-414-APC
or FERMILAB-FN-0949-AD
or FERMILAB-CONF-12-472-A
or FERMILAB-CONF-12-524-CD
or FERMILAB-PUB-12-536-A
or FERMILAB-PUB-12-540-PPD
or FERMILAB-TEST-12-003-BSS
or FERMILAB-CONF-12-545-AD-TD
or FERMILAB-PUB-09-845-CMS
or FERMILAB-PUB-09-846-CMS
or FERMILAB-PUB-10-727-CMS
or FERMILAB-PUB-12-562-AD-APC
or FERMILAB-PUB-11-816-CMS
or FERMILAB-PUB-12-651-PPD
or FERMILAB-CONF-04-559-APC
or FERMILAB-CONF-03-528-AD
or FERMILAB-FN-0953-APC
or FERMILAB-CONF-03-529-AD
or FERMILAB-TEST-13-001-A
or FERMILAB-CONF-01-533-APC
or FERMILAB-CONF-99-000-AD
or FERMILAB-TM-2552-TD
or FERMILAB-PUB-13-043-T
or FERMILAB-CONF-13-056-AD
or FERMILAB-CONF-13-058-AD
or FERMILAB-CONF-13-060-AD-APC
or FERMILAB-PUB-13-070-E-PPD
or FERMILAB-CONF-13-074-CD
or FERMILAB-PUB-13-075-T
or FERMILAB-CONF-13-078-PPD
or FERMILAB-PUB-06-591-PPD
or FERMILAB-PUB-12-668-PPD
or FERMILAB-CONF-13-110-AD
or FERMILAB-CONF-13-112-AD
or FERMILAB-CONF-12-723-E
or FERMILAB-FN-0959-APC
or FERMILAB-CONF-13-211-PPD
or FERMILAB-TM-2559-APC-PPD
or FERMILAB-PUB-12-800-AE-E
or FERMILAB-CONF-13-245-AD-APC-PPD-T-TD
or FERMILAB-PUB-13-280-T
or FERMILAB-PUB-13-283-T
or FERMILAB-TM-2562-APC
or FERMILAB-CONF-13-292-AD
or FERMILAB-CONF-13-293-AD
or FERMILAB-CONF-13-294-AD
or FERMILAB-CONF-13-312-AD
or FERMILAB-PUB-13-316-PPD
or FERMILAB-CONF-10-731-PPD
or FERMILAB-CONF-11-882-CD
or FERMILAB-CONF-13-359-TD
or FERMILAB-CONF-13-369-TD
or FERMILAB-CONF-13-378-AD
or FERMILAB-PUB-13-384-CMS
or FERMILAB-PUB-13-385-E
or FERMILAB-CONF-13-000-DI
or FERMILAB-TM-2568
or FERMILAB-CONF-13-482-CD
or FERMILAB-PUB-13-491-CD
or FERMILAB-CONF-13-496-CD
or FERMILAB-PUB-13-503-T
or FERMILAB-PUB-13-530-T
or FERMILAB-PUB-13-532-T
or FERMILAB-CONF-13-545-T
or FERMILAB-CONF-13-558-T
or FERMILAB-TEST-13-003-BSS
or FERMILAB-PUB-13-576-E-PPD
or FERMILAB-CONF-13-578-T
or FERMILAB-PUB-14-013-A
or FERMILAB-TM-2578-CD
or FERMILAB-CONF-14-019
or FERMILAB-PUB-14-026-PPD
or FERMILAB-CONF-12-911-E
or FERMILAB-PUB-14-049-AD-TD
or FERMILAB-TM-2583-PPD
or FERMILAB-PUB-14-085-CMS
or FERMILAB-PUB-12-913-CMS
or FERMILAB-PUB-12-918-CMS
or FERMILAB-PUB-08-716-CMS
or FERMILAB-PUB-07-807-CMS
or FERMILAB-PUB-07-808-CMS
or FERMILAB-PUB-07-809-CMS
or FERMILAB-PUB-06-592-CMS
or FERMILAB-CONF-14-097-E
or FERMILAB-PUB-14-112-PPD
or FERMILAB-CONF-13-648
or FERMILAB-TEST-14-001-AE-DI
or FERMILAB-TEST-14-002-BSS
or FERMILAB-CONF-14-149-AD
or FERMILAB-PUB-14-153-CMS
or FERMILAB-PUB-14-156-TD
or FERMILAB-PUB-14-158-TD
or FERMILAB-PUB-14-159-TD
or FERMILAB-TM-2585
or FERMILAB-PUB-14-183-T
or FERMILAB-CONF-14-221-APC
or FERMILAB-CONF-14-223-PPD
or FERMILAB-PUB-14-236-A
or FERMILAB-PUB-14-238-PPD
or FERMILAB-PUB-14-240-A
or FERMILAB-PUB-14-242-E
or FERMILAB-PUB-14-245-TD
or FERMILAB-PUB-14-251-CMS
or FERMILAB-PUB-14-252-CMS
or FERMILAB-PUB-14-253-A
or FERMILAB-FN-0984-AD-PPD
or FERMILAB-PUB-14-263-T
or FERMILAB-PUB-14-264-T
or FERMILAB-CONF-14-265-E
or FERMILAB-CONF-14-267-E
or FERMILAB-TEST-14-003-ESH
"""

x = perform_request_search(p=search,cc='HEP')
for r in x:
    report_fermilab = ''
    eprint = ''
    reports = get_fieldvalues(r,'037__a')
    for report in reports:
        if re.search("FERMILAB", report):
            report_fermilab = report
    bfo = BibFormatObject(r)
    eprint = bfe_arxiv.get_arxiv(bfo, category = "no")
    if eprint: 
        eprint = eprint[0]
        if report_fermilab:
            print report_fermilab, eprint
#        out += format_bibtex_field("eprint",
#                                   eprints[0],
#                                   name_width,
#                                   value_width)
#        out += format_bibtex_field("archivePrefix",
#                                   "arXiv",
#                                   name_width,
#                                   value_width)
